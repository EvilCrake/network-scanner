# Техническое задание: Автоматический сканер сети

## 1. Общие сведения

### 1.1 Назначение
Разработка высокопроизводительного автоматического сканера сети для операционной системы Windows, предназначенного для обнаружения активных устройств в локальной сети, определения их операционных систем и сбора метаданных.

### 1.2 Целевая платформа
- Операционная система: Microsoft Windows 10/11
- Требования: Права администратора для полного функционала

## 2. Функциональные требования

### 2.1 Обнаружение устройств
- **ARP сканирование**: Использование ARP таблицы для быстрого обнаружения устройств в локальной подсети
- **ICMP ping**: Проверка доступности устройств через ICMP эхо-запросы
- **TCP порты**: Сканирование открытых портов для идентификации сервисов
- **Многоадресное сканирование**: Параллельное сканирование нескольких IP-адресов для повышения производительности

### 2.2 Определение операционной системы
- **Fingerprinting по TTL**: Анализ значения TTL в ответах ICMP/TCP
- **TCP Window Size**: Анализ размера окна TCP для определения ОС
- **Banner grabbing**: Извлечение информации из баннеров открытых сервисов
- **SNMP опрос** (опционально): Получение системной информации через SNMP

### 2.3 Сбор данных об устройствах
Для каждого обнаруженного устройства собирать:
- IP-адрес
- MAC-адрес
- Имя хоста (hostname)
- Операционная система (с вероятностью определения)
- Открытые порты и сервисы
- Время последнего ответа
- Производитель сетевого адаптера (по OUI MAC-адреса)
- Время жизни устройства в сети (uptime, если доступно)

### 2.4 Экспорт данных
Поддержка экспорта в три формата с типизированной структурой:

#### 2.4.1 CSV формат
Стандартизированные колонки:
- `ip_address`, `mac_address`, `hostname`, `os_type`, `os_version`, `os_confidence`, `vendor`, `open_ports`, `services`, `first_seen`, `last_seen`, `status`

#### 2.4.2 JSON формат
Структура согласно стандарту JSON для сетевых устройств:
```json
{
  "scan_metadata": {
    "timestamp": "ISO 8601",
    "scanner_version": "1.0.0",
    "network_range": "192.168.1.0/24"
  },
  "devices": [
    {
      "ip": "192.168.1.1",
      "mac": "00:11:22:33:44:55",
      "hostname": "router.local",
      "os": {
        "type": "Linux",
        "version": "Unknown",
        "confidence": 0.75
      },
      "network": {
        "vendor": "Vendor Name",
        "ports": [22, 80, 443],
        "services": ["SSH", "HTTP", "HTTPS"]
      },
      "timestamps": {
        "first_seen": "2025-12-01T08:00:00Z",
        "last_seen": "2025-12-01T08:00:00Z"
      },
      "status": "online"
    }
  ]
}
```

#### 2.4.3 TXT формат
Человекочитаемый формат с разделителями для интеграции с текстовыми инструментами.

## 3. Нефункциональные требования

### 3.1 Производительность
- **Скорость сканирования**: Минимум 1000 IP-адресов в минуту
- **Параллелизм**: Использование асинхронного программирования или многопоточности
- **Оптимизация**: Минимизация сетевого трафика и использование кэширования

### 3.2 Надежность
- Обработка таймаутов и сетевых ошибок
- Логирование операций для отладки
- Graceful degradation при отсутствии прав администратора

### 3.3 Безопасность
- Минимизация агрессивного сканирования (уважение к сетевой политике)
- Возможность настройки скорости сканирования
- Предупреждения о необходимости прав администратора

## 4. Технические требования

### 4.1 Язык программирования
**Python 3.9+** с использованием:
- `asyncio` для асинхронного сканирования
- `scapy` или `python-nmap` для сетевых операций
- Стандартные библиотеки для работы с сетью

### 4.2 Зависимости
- Минимальное количество внешних зависимостей
- Кроссплатформенные библиотеки с поддержкой Windows

### 4.3 Интерфейс
- **CLI (Command Line Interface)**: Основной интерфейс
- Параметры командной строки для настройки диапазона сканирования, формата вывода, таймаутов

## 5. Структура проекта

```
network_scanner/
├── scanner/
│   ├── __init__.py
│   ├── network_scanner.py      # Основной модуль сканирования
│   ├── os_detection.py          # Определение ОС
│   ├── device_info.py           # Сбор информации об устройстве
│   └── exporters.py             # Экспорт в различные форматы
├── config/
│   └── settings.py              # Конфигурация
├── utils/
│   ├── __init__.py
│   └── helpers.py               # Вспомогательные функции
├── main.py                      # Точка входа
├── requirements.txt             # Зависимости
└── README.md                    # Документация
```

## 6. Алгоритм работы

1. **Инициализация**: Определение сетевого интерфейса и диапазона IP
2. **ARP Discovery**: Быстрое сканирование через ARP для локальной подсети
3. **ICMP Verification**: Проверка доступности через ping
4. **Port Scanning**: Сканирование стандартных портов (22, 80, 443, 135, 445, 3389 и др.)
5. **OS Detection**: Анализ ответов для определения ОС
6. **Data Collection**: Сбор дополнительной информации (hostname, сервисы)
7. **Export**: Сохранение результатов в выбранном формате

## 7. Критерии приемки

- [ ] Сканирование подсети /24 за время < 2 минут
- [ ] Определение ОС с точностью > 70% для популярных систем
- [ ] Корректный экспорт во все три формата (CSV, JSON, TXT)
- [ ] Работа с правами пользователя (ограниченный функционал) и администратора (полный функционал)
- [ ] Обработка ошибок без падений приложения
- [ ] Документация по использованию

## 8. Дополнительные возможности (опционально)

- Веб-интерфейс для визуализации результатов
- Сохранение истории сканирований
- Сравнение результатов разных сканирований
- Уведомления о новых устройствах
- Интеграция с базами данных

