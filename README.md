# Network Scanner

Автоматический сканер локальной сети для Windows, определяющий доступные устройства, их ОС и сетевые характеристики с экспортом отчетов в удобные форматы.

## Функциональность

- **Асинхронное сканирование** подсетей /24 и больше с контролем параллелизма.
- **ICMP/ARP/TCP** проверки с автоматическим переходом в fallback-режим, если Scapy недоступен или нет прав администратора.
- **Определение ОС** на основе TTL, TCP window size и открытых портов.
- **Сбор метаданных**: MAC-адрес, hostname, производитель, открытые порты, сервисы, временные метки.
- **Автообновляемый справочник производителей**: кэшируемая база IEEE OUI скачивается онлайн и уточняет бренд устройства.
- **Экспорт отчетов** в JSON, CSV или TXT. Формат можно указать строкой (`json`) либо цифрой (`1`, `2`, `3`), а при отсутствии параметра приложение предложит выбрать вариант в интерактивном меню.
- **Тихий режим по умолчанию**: прогресс-логирование отключено для чистой консоли, но его можно включить флагом `--verbose`.

## Установка

### Требования

- Windows 10/11, Python 3.9+
- Права администратора желательны (для ARP/RAW-сокетов)
- Npcap в режиме WinPcap API (https://npcap.com/) — для полноценной работы Scapy
- Доступ в интернет (разово) для обновления базы производителей по MAC-адресам

### Метод 1. Быстрый старт

```bash
git clone https://example.com/network_scanner.git
cd network_scanner
python -m pip install -r requirements.txt
```

### Метод 2. Через виртуальное окружение

```bash
python -m venv .venv
.venv\Scripts\activate
python -m pip install -r requirements.txt
```

### Метод 3. Portable-установка (без глобальных изменений)

1. Скачайте ZIP-архив проекта и распакуйте в удобную папку.
2. Установите зависимости локально:
   ```bash
   python -m pip install --upgrade pip
   python -m pip install --target ".deps" -r requirements.txt
   ```
3. Запускайте приложение с добавлением пути `.deps`:
   ```bash
   set PYTHONPATH=.deps;%PYTHONPATH%
   python main.py --auto
   ```

> Если `netifaces` не устанавливается из-за отсутствия Microsoft C++ Build Tools, приложение продолжит работу: для Windows предусмотрен парсинг `ipconfig`.

## Использование

### Базовые сценарии

```bash
# Автоопределение сети
python main.py --auto

# Сканирование заданного диапазона
python main.py --range 192.168.1.0/24
```

### Выбор формата отчета

- Передайте строку: `--format json|csv|txt`
- Или цифру: `--format 1|2|3` (1 — JSON, 2 — CSV, 3 — TXT)
- Если параметр не указан, появится интерактивный запрос:
  ```
  Select export format:
    1) JSON (default)
    2) CSV
    3) TXT
  Enter choice [1-3] (default 1):
  ```

### Основные флаги

```
--range, -r      Диапазон сети (пример: 192.168.1.0/24)
--auto, -a       Автоопределение локальной сети
--format, -f     Формат экспорта или цифра 1-3
--output, -o     Префикс файла (по умолчанию network_scan)
--timeout, -t    Таймаут сетевых операций, секунды (2.0)
--verbose, -v    Подробные логи прогресса
```

### Примеры команд

```bash
# Экспорт JSON с автодиапазоном
python main.py --auto --format 1 --output scan

# CSV-отчет и явный диапазон
python main.py --range 10.0.0.0/24 --format csv

# TXT-отчет + подробные логи
python main.py --auto --format txt --verbose

# Быстрый запуск с увеличенным таймаутом
python main.py --auto --timeout 5
```

### Экспортируемые форматы

- **JSON (1)** — структурированные данные с метаданными сканирования и устройствами в удобном для парсинга виде.
- **CSV (2)** — таблица с полями: `ip_address`, `mac_address`, `hostname`, `os_type`, `vendor`, `open_ports`, `status` и т.д.
- **TXT (3)** — читаемый отчет со сводкой по каждому устройству (IP, MAC, hostname, OS, порты).

Отчеты сохраняются в файлы `network_scan.<ext>` (или другой префикс, если задан `--output`). В JSON и TXT используется UTF-8 без экранирования русских символов.

---

**Версия:** 1.0.0  
**Дата:** 2025-12-01

